.DEFAULT: all

all: $(TARGETS) $(EXTRA_DEPS) .gitignore

$(ELFS): $(SOURCES) $(LDSCRIPT)
	$(CC) $(CFLAGS) $(SOURCES) -o $@ -T $(LDSCRIPT) -Wl,-N $(DEFINES)

$(TARGETS): $(ELFS)
	$(OBJCOPY) -O binary $(subst .bin,.elf,$@) $@ 

clean:
	rm -f $(ELFS)
	rm -f $(TARGETS)
.gitignore: Makefile
	@for x in $(ELFS) $(TARGETS); do \
		echo "$$x"; \
	done >> ../$@ 