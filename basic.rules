OBJECTS=$(SOURCES:.c=.o)
INCLUDES=-I. -Iinclude -I$(PWD)/include
EXTRA_DEPS += $(HEADERS)

.DEFAULT: all

all: $(TARGET) $(EXTRA_DEPS) .gitignore

%.o: %.c
	$(CC) -c $(CFLAGS) $(INCLUDES) -o $@ $^

$(TARGET): $(OBJECTS) $(EXTRA_OBJECTS)
	$(CC) -o $@ $^ $(LIBS)

clean:
	rm -f $(EXTRA_OBJECTS)
	rm -f $(OBJECTS)
	rm -f $(TARGET)

.gitignore: Makefile
	@for x in $(OBJECTS) $(EXTRA_OBJECTS) $(TARGET); do \
		echo "$$x"; \
	done >> $(PWD)/$@ 
